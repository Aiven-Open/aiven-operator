<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Aiven Operator â€“ Installation</title><link>https://aiven.github.io/aiven-operator/docs/installation/</link><description>Recent content in Installation on Aiven Operator</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><atom:link href="https://aiven.github.io/aiven-operator/docs/installation/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Prerequisites</title><link>https://aiven.github.io/aiven-operator/docs/installation/prerequisites/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://aiven.github.io/aiven-operator/docs/installation/prerequisites/</guid><description>
&lt;p>The Aiven Operator for Kubernetes supports all major Kubernetes distributions, both locally and in the cloud.&lt;/p>
&lt;p>Make sure you have the following:&lt;/p>
&lt;ul>
&lt;li>To use the operator, you need admin access to a Kubernetes cluster.&lt;/li>
&lt;li>For playground usage you can use &lt;a href="https://kind.sigs.k8s.io/">kind&lt;/a> for example.&lt;/li>
&lt;/ul></description></item><item><title>Docs: Installing from manifests</title><link>https://aiven.github.io/aiven-operator/docs/installation/manifests/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://aiven.github.io/aiven-operator/docs/installation/manifests/</guid><description>
&lt;p>The Aiven Operator for Kubernetes can be installed by applying the manifests present in the GitHub repository.&lt;/p>
&lt;ol>
&lt;li>Install the &lt;code>cert-manager&lt;/code> operator.&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>&lt;a href="https://cert-manager.io/">cert-manager&lt;/a> is used to manage the Operator &lt;a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/">webhooks&lt;/a> TLS certificates.&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ kubectl apply -f https://github.com/jetstack/cert-manager/releases/latest/download/cert-manager.yaml
&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>Install the operator:&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ kubectl apply -f https://github.com/aiven/aiven-operator/releases/latest/download/deployment.yaml
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You&amp;rsquo;ve now installed the Aiven Operator for Kubernetes. &lt;a href="https://aiven.github.io/aiven-operator/aiven-operator/docs/installation/verifying/">Verify your installation&lt;/a>.&lt;/p></description></item><item><title>Docs: Installing with Helm</title><link>https://aiven.github.io/aiven-operator/docs/installation/helm/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://aiven.github.io/aiven-operator/docs/installation/helm/</guid><description>
&lt;p>The Aiven Operator for Kubernetes can be installed via &lt;a href="https://helm.sh/">Helm&lt;/a>.
Please follow The instruction in the &lt;a href="https://github.com/aiven/aiven-charts">aiven-charts&lt;/a> GitHub repository.&lt;/p>
&lt;p>Once you installed the Aiven Operator for Kubernetes you can &lt;a href="https://aiven.github.io/aiven-operator/aiven-operator/docs/installation/verifying/">verify your installation&lt;/a>.&lt;/p></description></item><item><title>Docs: Verifying the installation</title><link>https://aiven.github.io/aiven-operator/docs/installation/verifying/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://aiven.github.io/aiven-operator/docs/installation/verifying/</guid><description>
&lt;p>Use the following commands to ensure your installation was successful.&lt;/p>
&lt;ul>
&lt;li>Verify that all the operator Pods are &lt;code>READY&lt;/code>, and their &lt;code>STATUS&lt;/code> is &lt;code>Running&lt;/code>.&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ kubectl get pod -n aiven-operator-system
NAME READY STATUS RESTARTS AGE
aiven-operator-controller-manager-576d944499-ggttj 1/1 Running &lt;span style="color:#ae81ff">0&lt;/span> 12m
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Verify that the &lt;code>cert-manager&lt;/code> Pods are running:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ kubectl get pod --namespace cert-manager
NAME READY STATUS RESTARTS AGE
cert-manager-7dd5854bb4-85cpv 1/1 Running &lt;span style="color:#ae81ff">0&lt;/span> 76s
cert-manager-cainjector-64c949654c-n2z8l 1/1 Running &lt;span style="color:#ae81ff">0&lt;/span> 77s
cert-manager-webhook-6bdffc7c9d-47w6z 1/1 Running &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">76&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Verify the operator startup logs. These should look like the code below (output trimmed):&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ kubectl logs -n aiven-operator-system -l control-plane&lt;span style="color:#f92672">=&lt;/span>controller-manager -f
2021-06-16T17:05:39.661Z INFO controller-runtime.metrics metrics server is starting to listen &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;addr&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;:8080&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
2021-06-16T17:05:39.699Z INFO controller-runtime.builder Registering a mutating webhook &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;GVK&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;aiven.io/v1alpha1, Kind=Project&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;path&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/mutate-aiven-io-v1alpha1-project&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
2021-06-16T17:05:39.699Z INFO controller-runtime.webhook registering webhook &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;path&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/mutate-aiven-io-v1alpha1-project&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>...&lt;span style="color:#f92672">]&lt;/span>
2021-06-16T17:05:39.901Z INFO setup starting manager
I0616 17:05:39.902448 &lt;span style="color:#ae81ff">1&lt;/span> leaderelection.go:243&lt;span style="color:#f92672">]&lt;/span> attempting to acquire leader lease aiven-operator-system/00272a53.aiven.io...
2021-06-16T17:05:39.902Z INFO controller-runtime.webhook.webhooks starting webhook server
2021-06-16T17:05:39.903Z INFO controller-runtime.certwatcher Updated current TLS certificate
2021-06-16T17:05:39.903Z INFO controller-runtime.webhook serving webhook server &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;host&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;port&amp;#34;&lt;/span>: 9443&lt;span style="color:#f92672">}&lt;/span>
2021-06-16T17:05:39.903Z INFO controller-runtime.certwatcher Starting certificate watcher
2021-06-16T17:05:39.902Z INFO controller-runtime.manager starting metrics server &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;path&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/metrics&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
I0616 17:05:40.017691 &lt;span style="color:#ae81ff">1&lt;/span> leaderelection.go:253&lt;span style="color:#f92672">]&lt;/span> successfully acquired lease aiven-operator-system/00272a53.aiven.io
2021-06-16T17:05:40.018Z DEBUG controller-runtime.manager.events Normal &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;object&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;kind&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;ConfigMap&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;namespace&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;aiven-operator-system&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;name&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;00272a53.aiven.io&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;uid&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;63bc05df-3df5-44d1-8344-41b05a6a3a4f&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;apiVersion&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;v1&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;resourceVersion&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;2073&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;reason&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;LeaderElection&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;aiven-operator-controller-manager-6d68c4d6d7-5s5kj_64fd1a06-44b6-4690-95e1-17ec8adf7ffe became leader&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
2021-06-16T17:05:40.098Z INFO controller-runtime.manager.controller.kafkatopic Starting EventSource &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;reconciler group&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;aiven.io&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;reconciler kind&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;KafkaTopic&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;source&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;kind source: /, Kind=&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
2021-06-16T17:05:40.018Z INFO controller-runtime.manager.controller.projectvpc Starting EventSource &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;reconciler group&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;aiven.io&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;reconciler kind&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ProjectVPC&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;source&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;kind source: /, Kind=&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>...&lt;span style="color:#f92672">]&lt;/span>
2021-06-16T17:05:40.097Z DEBUG controller-runtime.manager.events Normal &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;object&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;kind&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;Lease&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;namespace&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;aiven-operator-system&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;name&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;00272a53.aiven.io&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;uid&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;a81127e0-7293-4b0f-b4f9-8fc78adba8e0&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;apiVersion&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;coordination.k8s.io/v1&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;resourceVersion&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;2074&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;reason&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;LeaderElection&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;aiven-operator-controller-manager-6d68c4d6d7-5s5kj_64fd1a06-44b6-4690-95e1-17ec8adf7ffe became leader&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
2021-06-16T17:05:40.998Z INFO controller-runtime.manager.controller.kafka Starting workers &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;reconciler group&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;aiven.io&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;reconciler kind&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Kafka&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;worker count&amp;#34;&lt;/span>: 1&lt;span style="color:#f92672">}&lt;/span>
2021-06-16T17:05:40.999Z INFO controller-runtime.manager.controller.serviceuser Starting workers &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;reconciler group&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;aiven.io&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;reconciler kind&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ServiceUser&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;worker count&amp;#34;&lt;/span>: 1&lt;span style="color:#f92672">}&lt;/span>
2021-06-16T17:05:40.999Z INFO controller-runtime.manager.controller.connectionpool Starting workers &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;reconciler group&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;aiven.io&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;reconciler kind&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ConnectionPool&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;worker count&amp;#34;&lt;/span>: 1&lt;span style="color:#f92672">}&lt;/span>
2021-06-16T17:05:40.999Z INFO controller-runtime.manager.controller.kafkaacl Starting workers &lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;reconciler group&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;aiven.io&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;reconciler kind&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;KafkaACL&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;worker count&amp;#34;&lt;/span>: 1&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You have now verified that your installation was successful.&lt;/p></description></item><item><title>Docs: Uninstalling</title><link>https://aiven.github.io/aiven-operator/docs/installation/uninstalling/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://aiven.github.io/aiven-operator/docs/installation/uninstalling/</guid><description>
&lt;h2 id="-warning-">ðŸš¨ Warning ðŸš¨&lt;/h2>
&lt;p>Uninstalling the Aiven Operator for Kubernetes can remove the resources created in Aiven, possibly resulting in data loss.&lt;/p>
&lt;h2 id="helmhttpshelmsh-based-installation">&lt;a href="https://helm.sh">Helm&lt;/a> based installation&lt;/h2>
&lt;p>Find out the name of your deployment:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ helm list
NAME NAMESPACE REVISION UPDATED STATUS CHART APP VERSION
aiven-operator default &lt;span style="color:#ae81ff">1&lt;/span> 2021-09-09 10:56:14.623700249 +0200 CEST deployed aiven-operator-v0.1.0 v0.1.0
aiven-operator-crds default &lt;span style="color:#ae81ff">1&lt;/span> 2021-09-09 10:56:05.736411868 +0200 CEST deployed aiven-operator-crds-v0.1.0 v0.1.0
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Remove the CRDs:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ helm uninstall aiven-operator-crds
release &lt;span style="color:#e6db74">&amp;#34;aiven-operator-crds&amp;#34;&lt;/span> uninstalled
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Remove the operator:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ helm uninstall aiven-operator
release &lt;span style="color:#e6db74">&amp;#34;aiven-operator&amp;#34;&lt;/span> uninstalled
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="dealing-with-expired-tokens">Dealing with expired tokens&lt;/h2>
&lt;p>Aiven resources need to have an accompanying secret that contains the token that is used to authorize the manipulation of that resource.
If that token expired then you will not be able to delete the custom resource and deletion will also hang until the situation is resolved.
The recommended approach to deal with that situation is to patch a valid token into the secret again so that proper cleanup of aiven resources can take place.&lt;/p>
&lt;h2 id="hanging-deletions">Hanging deletions&lt;/h2>
&lt;p>To protect the secrets that the operator is using from deletion, it adds the &lt;a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/finalizers/">finalizer&lt;/a> &lt;code>finalizers.aiven.io/needed-to-delete-services&lt;/code> to the secret.
This solves a race condition that happens when deleting a namespace, where there is a possibility of the secret getting deleted before the resource that uses it.
When the controller is deleted it may not cleanup the finalizers from all secrets.
If there is a secret with this finalizer blocking deletion of a namespace, for now please do&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">kubectl patch secret &amp;lt;offending-secret&amp;gt; -p &lt;span style="color:#e6db74">&amp;#39;{&amp;#34;metadata&amp;#34;:{&amp;#34;finalizers&amp;#34;:null}}&amp;#39;&lt;/span> --type&lt;span style="color:#f92672">=&lt;/span>merge
&lt;/code>&lt;/pre>&lt;/div>&lt;p>to remove the finalizer.&lt;/p></description></item></channel></rss>